import{_ as h}from"./ViewBreadcrumbs-4b359d23.js";import{_ as H}from"./CustomActions-66702b46.js";import{O as I}from"./OrganizationsIcon-e8830605.js";import{L as j}from"./LayoutHeader-675e8e49.js";import{_ as E}from"./OrganizationModal-e15bae41.js";import{N,$ as J,O as T,y as F,a0 as Y,z as G,l as g,e as x,f as u,c as k,b as n,w as p,u as y,F as U,r as K,g as _,n as W,B as b,Y as Q,d as A,t as O,a1 as X}from"./index-69690053.js";import{H as S,_ as Z}from"./ListBulkActions-cb4cad70.js";import{_ as ee,a as te,b as le,c as oe,d as ae,e as se}from"./DeleteLinkedDocModal-79804aa3.js";import{a as ne,D as ie,b as ue,f as q,w as re,t as de}from"./index-d7cc16ab.js";import{_ as me}from"./ListFooter-9b7dc541.js";import{_ as pe}from"./ViewControls-63f15722.js";import"./Link-f750ab7e.js";import"./Icon-1aad9751.js";import"./DragVerticalIcon-fa78fa9d.js";import"./FieldLayout-75a1161d.js";import"./modals-062b592e.js";import"./global-9f2067e0.js";import"./IndicatorIcon-12e98f89.js";import"./settings-582196d0.js";import"./description-89b9b637.js";import"./FadedScrollableDiv-bd4c4285.js";import"./IconPicker-10368ec7.js";import"./PinIcon-f3d77cb4.js";import"./DetailsIcon-e10d9cec.js";const fe={key:0},ve=["onClick"],ye={key:1},ce={key:2},ke=["onClick"],ge={__name:"OrganizationsListView",props:N({rows:{type:Array,required:!0},columns:{type:Array,required:!0},options:{type:Object,default:()=>({selectable:!0,showTooltip:!0,resizeColumn:!1,totalCount:0,rowCount:0})}},{modelValue:{},modelModifiers:{},list:{},listModifiers:{}}),emits:N(["loadMore","updatePageCount","columnWidthUpdated","applyFilter","applyLikeFilter","likeDoc","selectionsChanged"],["update:modelValue","update:list"]),setup(r,{expose:L,emit:M}){const f=M,w=J(),c=T(r,"modelValue"),s=T(r,"list"),$=F(()=>{var i,l;return!!((l=(i=s.value.params)==null?void 0:i.filters)!=null&&l._liked_by)}),{user:z}=Y();function V(i){if(i)return JSON.parse(i).includes(z)}G(c,(i,l)=>{i!==l&&f("updatePageCount",i)});const v=g(null);return L({customListActions:F(()=>{var i;return(i=v.value)==null?void 0:i.customListActions})}),(i,l)=>{const t=x("Button"),C=x("FormControl");return u(),k(U,null,[n(y(se),{columns:r.columns,rows:r.rows,options:{getRowRoute:e=>({name:"Organization",params:{organizationId:e.name},query:{view:y(w).query.view,viewType:y(w).params.viewType}}),selectable:r.options.selectable,showTooltip:r.options.showTooltip,resizeColumn:r.options.resizeColumn},"row-key":"name","onUpdate:selections":l[2]||(l[2]=e=>f("selectionsChanged",e))},{default:p(()=>[n(y(ee),{class:"sm:mx-5 mx-3",onColumnWidthUpdated:l[1]||(l[1]=e=>f("columnWidthUpdated"))},{default:p(()=>[(u(!0),k(U,null,K(r.columns,e=>(u(),_(y(te),{key:e.key,item:e,onColumnWidthUpdated:o=>f("columnWidthUpdated",e)},{default:p(()=>[e.key=="_liked_by"?(u(),_(t,{key:0,variant:"ghosted",class:W(["!h-4",$.value?"fill-red-500":"fill-white"]),onClick:l[0]||(l[0]=()=>f("applyLikeFilter"))},{default:p(()=>[n(S,{class:"h-4 w-4"})]),_:1},8,["class"])):b("",!0)]),_:2},1032,["item","onColumnWidthUpdated"]))),128))]),_:1}),n(le,{class:"mx-3 sm:mx-5",rows:r.rows,doctype:"CRM Organization"},{default:p(({idx:e,column:o,item:d})=>[n(y(oe),{item:d,align:o.align},{prefix:p(()=>[o.key==="organization_name"?(u(),k("div",fe,[d.label?(u(),_(y(ne),{key:0,class:"flex items-center",image:d.logo,label:d.label,size:"sm"},null,8,["image","label"])):b("",!0)])):b("",!0)]),default:p(({label:a})=>[["modified","creation"].includes(o.key)?(u(),k("div",{key:0,class:"truncate text-base",onClick:m=>f("applyFilter",{event:m,idx:e,column:o,item:d,firstColumn:r.columns[0]})},[n(y(Q),{text:d.label},{default:p(()=>[A("div",null,O(d.timeAgo),1)]),_:2},1032,["text"])],8,ve)):o.type==="Check"?(u(),k("div",ye,[n(C,{type:"checkbox",modelValue:d,disabled:!0,class:"text-ink-gray-9"},null,8,["modelValue"])])):o.key==="_liked_by"?(u(),k("div",ce,[o.key=="_liked_by"?(u(),_(t,{key:0,variant:"ghosted",class:W(V(d)?"fill-red-500":"fill-white"),onClick:X(()=>f("likeDoc",{name:i.row.name,liked:V(d)}),["stop","prevent"])},{default:p(()=>[n(S,{class:"h-4 w-4"})]),_:1},8,["class","onClick"])):b("",!0)])):(u(),k("div",{key:3,class:"truncate text-base",onClick:m=>f("applyFilter",{event:m,idx:e,column:o,item:d,firstColumn:r.columns[0]})},O(a),9,ke))]),_:2},1032,["item","align"])]),_:1},8,["rows"]),n(y(ae),null,{actions:p(({selections:e,unselectAll:o})=>[n(y(ie),{options:v.value.bulkActions(e,o)},{default:p(()=>[n(t,{icon:"more-horizontal",variant:"ghost"})]),_:1},8,["options"])]),_:1})]),_:1},8,["columns","rows","options"]),n(y(me),{class:"border-t sm:px-5 px-3 py-2",modelValue:c.value,"onUpdate:modelValue":l[3]||(l[3]=e=>c.value=e),options:{rowCount:r.options.rowCount,totalCount:r.options.totalCount},onLoadMore:l[4]||(l[4]=e=>f("loadMore"))},null,8,["modelValue","options"]),n(Z,{ref_key:"listBulkActionsRef",ref:v,modelValue:s.value,"onUpdate:modelValue":l[5]||(l[5]=e=>s.value=e),doctype:"CRM Organization",options:{hideAssign:!0}},null,8,["modelValue"])],64)}}},Ce={key:1,class:"flex h-full items-center justify-center"},_e={class:"flex flex-col items-center gap-3 text-xl font-medium text-ink-gray-4"},je={__name:"Organizations",setup(r){const{getFormattedPercent:L,getFormattedFloat:M,getFormattedCurrency:f}=ue("CRM Organization"),w=g(null),c=g(!1),s=g({}),$=g(1),z=g(1),V=g(20),v=g(null),i=F(()=>{var l,t,C;return!((t=(l=s.value)==null?void 0:l.data)!=null&&t.data)||!["list","group_by"].includes(s.value.data.view_type)?[]:(C=s.value)==null?void 0:C.data.data.map(e=>{var d;let o={};return(d=s.value)==null||d.data.rows.forEach(a=>{var B,D,R;o[a]=e[a];let m=(R=(D=(B=s.value)==null?void 0:B.data.columns)==null?void 0:D.find(P=>(P.key||P.value)==a))==null?void 0:R.type;m&&["Date","Datetime"].includes(m)&&!["modified","creation"].includes(a)&&(o[a]=q(e[a],"",!0,m=="Datetime")),m&&m=="Currency"&&(o[a]=f(a,e)),m&&m=="Float"&&(o[a]=M(a,e)),m&&m=="Percent"&&(o[a]=L(a,e)),a==="organization_name"?o[a]={label:e.organization_name,logo:e.organization_logo}:a==="website"?o[a]=re(e.website):["modified","creation"].includes(a)&&(o[a]={label:q(e[a]),timeAgo:__(de(e[a]))})}),o})});return(l,t)=>{const C=x("Button");return u(),k(U,null,[n(j,null,{"left-header":p(()=>[n(h,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=e=>v.value=e),routeName:"Organizations"},null,8,["modelValue"])]),"right-header":p(()=>{var e;return[(e=w.value)!=null&&e.customListActions?(u(),_(H,{key:0,actions:w.value.customListActions},null,8,["actions"])):b("",!0),n(C,{variant:"solid",label:l.__("Create"),iconLeft:"plus",onClick:t[1]||(t[1]=o=>c.value=!0)},null,8,["label"])]}),_:1}),n(pe,{ref_key:"viewControls",ref:v,modelValue:s.value,"onUpdate:modelValue":t[2]||(t[2]=e=>s.value=e),loadMore:$.value,"onUpdate:loadMore":t[3]||(t[3]=e=>$.value=e),resizeColumn:z.value,"onUpdate:resizeColumn":t[4]||(t[4]=e=>z.value=e),updatedPageCount:V.value,"onUpdate:updatedPageCount":t[5]||(t[5]=e=>V.value=e),doctype:"CRM Organization"},null,8,["modelValue","loadMore","resizeColumn","updatedPageCount"]),s.value.data&&i.value.length?(u(),_(ge,{key:0,ref_key:"organizationsListView",ref:w,modelValue:s.value.data.page_length_count,"onUpdate:modelValue":t[6]||(t[6]=e=>s.value.data.page_length_count=e),list:s.value,"onUpdate:list":t[7]||(t[7]=e=>s.value=e),rows:i.value,columns:s.value.data.columns,options:{showTooltip:!1,resizeColumn:!0,rowCount:s.value.data.row_count,totalCount:s.value.data.total_count},onLoadMore:t[8]||(t[8]=()=>$.value++),onColumnWidthUpdated:t[9]||(t[9]=()=>z.value++),onUpdatePageCount:t[10]||(t[10]=e=>V.value=e),onApplyFilter:t[11]||(t[11]=e=>v.value.applyFilter(e)),onApplyLikeFilter:t[12]||(t[12]=e=>v.value.applyLikeFilter(e)),onLikeDoc:t[13]||(t[13]=e=>v.value.likeDoc(e)),onSelectionsChanged:t[14]||(t[14]=e=>v.value.updateSelections(e))},null,8,["modelValue","list","rows","columns","options"])):s.value.data?(u(),k("div",Ce,[A("div",_e,[n(I,{class:"h-10 w-10"}),A("span",null,O(l.__("No {0} Found",[l.__("Organizations")])),1),n(C,{label:l.__("Create"),iconLeft:"plus",onClick:t[15]||(t[15]=e=>c.value=!0)},null,8,["label"])])])):b("",!0),c.value?(u(),_(E,{key:2,modelValue:c.value,"onUpdate:modelValue":t[16]||(t[16]=e=>c.value=e)},null,8,["modelValue"])):b("",!0)],64)}}};export{je as default};
//# sourceMappingURL=Organizations-3551e83f.js.map
